const Eventful=(()=>{let e=0;const t={_id:{writable:!0},_events:{writable:!0},_listeningTo:{writable:!0},initialize:{enumerable:!0,value:function(){return this._id="eventful"+e++,this._events={},this._listeningTo={},this}},on:{enumerable:!0,value:function(e,t,i){this._events[e]||(this._events[e]=[]);const s={handler:t};return i&&(s.owner=i,i._listeningTo[this._id]||(i._listeningTo[this._id]={ref:this,handlers:[]}),i._listeningTo[this._id].handlers.push(t)),this._events[e].push(s),this}},off:{enumerable:!0,value:function(e,t,i){const s=s=>{let n=0;for(;n<this._events[s].length;){const{handler:r,owner:o}=this._events[s][n];if(t&&t!==r||i&&i!==o)n++;else{if(o&&o._listeningTo&&o._listeningTo[this._id]){const e=o._listeningTo[this._id].handlers.indexOf(r);-1!==e&&(o._listeningTo[this._id].handlers.splice(e,1),0===o._listeningTo[this._id].handlers.length&&delete o._listeningTo[this._id])}if(this._events[s].splice(n,1),e&&t)break}}0===this._events[s].length&&delete this._events[s]};if(e)this._events[e]&&s(e);else for(const e in this._events)s(e);return this}},trigger:{enumerable:!0,value:function(e,...t){if(this._events[e]){const i=[...this._events[e].map((({handler:e})=>e))];for(let s=0,n=i.length;s<n;s++){const n=i[s],r=n.call(this,...t);r&&r.off&&this.off(e,n)}}return this}},listenTo:{enumerable:!0,value:function(e,t,i){return e.on(t,i,this),this}},stopListeningTo:{enumerable:!0,value:function(e,t,i){const s=e=>{const{ref:s}=this._listeningTo[e];s.off(t,i,this)};if(e)this._listeningTo[e._id]&&s(e._id);else for(const e in this._listeningTo)s(e);return this}},terminate:{enumerable:!0,value:function(){this.off(),this.stopListeningTo()}}};const i=class{constructor(){this.initialize()}};Object.defineProperties(i.prototype,t);const s=Object.assign({},t,{_listeners:{writable:!0},initialize:{enumerable:!0,value(){t.initialize.value.call(this),this._listeners={}}},on:{value(e,i,s){return t.on.value.call(this,e,i,s),this._listeners[e]||this.addEventListener(e,this._listeners[e]=(...t)=>{this.trigger(e,...t)}),this}},off:{value(e,i,s){const n=[];if(e)this._events[e]&&n.push(e);else for(const e in this._events)n.push(e);t.off.value.call(this,e,i,s);for(let e=0,t=n.length;e<t;e++){const t=n[e];this._listeners[t]&&!this._events[t]&&(this.removeEventListener(t,this._listeners[t]),delete this._listeners[t])}return this}}});return{propertyDescriptors:t,factory:function(e={}){return Object.defineProperties(e,t).initialize()},Class:i,domPropertyDescriptors:s,domFactory:function(e){return"string"==typeof e&&(e=document.getElementById(e)),Object.defineProperties(e,s).initialize()}}})();export const{propertyDescriptors:propertyDescriptors,factory:factory,Class:Class,domPropertyDescriptors:domPropertyDescriptors,domFactory:domFactory}=Eventful;
//# sourceMappingURL=eventful.min.js.map
