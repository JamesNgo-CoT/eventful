const Eventful=(()=>{let e=0;const t={_id:{writable:!0},_events:{writable:!0},_listeningTo:{writable:!0},initialize:{enumerable:!0,value(){return this._id="eventful"+e++,this._events={},this._listeningTo={},this}},on:{enumerable:!0,value(e,t,s){return this._events[e]||(this._events[e]=[]),this._events[e].push({handler:t,owner:s}),s&&(s._listeningTo[this._id]||(s._listeningTo[this._id]={ref:this,handlers:[]}),s._listeningTo[this._id].handlers.push(t)),this}},off:{enumerable:!0,value(e,t,s){const i=i=>{let n=0;for(;n<this._events[i].length;){const{handler:r,owner:l}=this._events[i][n];if(t&&t!==r||s&&s!==l)n++;else{if(l&&l._listeningTo&&l._listeningTo[this._id]){const e=l._listeningTo[this._id].handlers.indexOf(r);-1!==e&&(l._listeningTo[this._id].handlers.splice(e,1),0===l._listeningTo[this._id].handlers.length&&delete l._listeningTo[this._id])}if(this._events[i].splice(n,1),e&&t)break}}0===this._events[i].length&&delete this._events[i]};if(e)this._events[e]&&i(e);else for(const e in this._events)i(e);return this}},trigger:{enumerable:!0,value(e,...t){if(this._events[e]){const s=[...this._events[e].map((({handler:e})=>e))];for(let i=0,n=s.length;i<n;i++){const n=s[i],r=n.call(this,...t);r&&r.off&&this.off(e,n)}}return this}},listenTo:{enumerable:!0,value(e,t,s){return e.on(t,s,this),this}},stopListeningTo:{enumerable:!0,value(e,t,s){const i=e=>{const{ref:i}=this._listeningTo[e];i.off(t,s,this)};if(e)this._listeningTo[e._id]&&i(e._id);else for(const e in this._listeningTo)i(e);return this}},terminate:{enumerable:!0,value(){this.off(),this.stopListeningTo()}}};function s(e={}){return Object.defineProperties(e,t),e}const i=class{constructor(){this.initialize()}};s(i.prototype);const n=Object.assign({},t,{_listeners:{writable:!0},initialize:{enumerable:!0,value(){t.initialize.value.call(this),this._listeners={}}},on:{value(e,s,i){return t.on.value.call(this,e,s,i),this._listeners[e]||this.addEventListener(e,this._listeners[e]=(...t)=>{this.trigger(e,...t)}),this}},off:{value(e,s,i){const n=[];if(e)this._events[e]&&n.push(e);else for(const e in this._events)n.push(e);t.off.value.call(this,e,s,i);for(let e=0,t=n.length;e<t;e++){const t=n[e];this._listeners[t]&&!this._events[t]&&(this.removeEventListener(t,this._listeners[t]),delete this._listeners[t])}return this}}});return{propertyDescriptors:t,factory:s,Class:i,domPropertyDescriptors:n,domFactory:function(e){return"string"==typeof e&&(e=document.getElementById(e)),Object.defineProperties(e,n),e}}})();export const{propertyDescriptors:propertyDescriptors,factory:factory,Class:Class,domPropertyDescriptors:domPropertyDescriptors,domFactory:domFactory}=Eventful;
//# sourceMappingURL=eventful.min.js.map
