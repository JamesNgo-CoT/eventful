const Eventful=(()=>{const{next:e}=IdSequence,t={_id:{writable:!0},_events:{writable:!0},_listeningTo:{writable:!0},initialize:{enumerable:!0,value:function(){return this._id=e("eventful"),this._events={},this._listeningTo={},this}},on:{enumerable:!0,value:function(e,t,i){this._events[e]||(this._events[e]=[]);const n={handler:t};return i&&(n.owner=i,i._listeningTo[this._id]||(i._listeningTo[this._id]={ref:this,handlers:[]}),i._listeningTo[this._id].handlers.push(t)),this._events[e].push(n),this}},off:{enumerable:!0,value:function(e,t,i){const n=n=>{let s=0;for(;s<this._events[n].length;){const{handler:l,owner:r}=this._events[n][s];if(t&&t!==l||i&&i!==r)s++;else{if(r&&r._listeningTo&&r._listeningTo[this._id]){const e=r._listeningTo[this._id].handlers.indexOf(l);-1!==e&&(r._listeningTo[this._id].handlers.splice(e,1),0===r._listeningTo[this._id].handlers.length&&delete r._listeningTo[this._id])}if(this._events[n].splice(s,1),e&&t)break}}0===this._events[n].length&&delete this._events[n]};if(e)this._events[e]&&n(e);else for(const e in this._events)n(e);return this}},trigger:{enumerable:!0,value:function(e,...t){if(this._events[e]){const i=[...this._events[e].map((({handler:e})=>e))];for(let n=0,s=i.length;n<s;n++){const s=i[n],l=s.call(this,...t);l&&l.off&&this.off(e,s)}}return this}},listenTo:{enumerable:!0,value:function(e,t,i){return e.on(t,i,this),this}},stopListeningTo:{enumerable:!0,value:function(e,t,i){const n=e=>{const{ref:n}=this._listeningTo[e];n.off(t,i,this)};if(e)this._listeningTo[e._id]&&n(e._id);else for(const e in this._listeningTo)n(e);return this}},terminate:{enumerable:!0,value:function(){this.off(),this.stopListeningTo()}}};const i=class{constructor(){this.initialize()}};Object.defineProperties(i.prototype,t);const n=Object.assign({},t,{_listeners:{writable:!0},initialize:{enumerable:!0,value(){t.initialize.value.call(this),this._listeners={}}},on:{value(e,i,n){return t.on.value.call(this,e,i,n),this._listeners[e]||this.addEventListener(e,this._listeners[e]=(...t)=>{this.trigger(e,...t)}),this}},off:{value(e,i,n){const s=[];if(e)this._events[e]&&s.push(e);else for(const e in this._events)s.push(e);t.off.value.call(this,e,i,n);for(let e=0,t=s.length;e<t;e++){const t=s[e];this._listeners[t]&&!this._events[t]&&(this.removeEventListener(t,this._listeners[t]),delete this._listeners[t])}return this}}});return{propertyDescriptors:t,factory:function(e={}){return Object.defineProperties(e,t).initialize()},Eventful:i,domPropertyDescriptors:n,domFactory:function(e){return"string"==typeof e&&(e=document.getElementById(e)),Object.defineProperties(e,n).initialize()}}})();
//# sourceMappingURL=eventful.min.js.map
