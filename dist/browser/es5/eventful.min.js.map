{"version":3,"file":"eventful.min.js","sources":["eventful.min.js"],"sourcesContent":["\"use strict\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/* global IdSequence */\nvar Eventful = function () {\n  var _IdSequence = IdSequence,\n      nextId = _IdSequence.next;\n  var methods = {\n    initialize: function initialize() {\n      this._id = nextId('eventful-');\n      this._events = {};\n      this._listeningTo = {};\n      return this;\n    },\n    terminate: function terminate() {\n      this.off();\n      this.stopListeningTo();\n      this.trigger('terminate');\n    },\n    on: function on(event, callback, owner) {\n      if (!this._events[event]) {\n        this._events[event] = [];\n      }\n\n      this._events[event].push({\n        callback: callback,\n        owner: owner\n      });\n\n      if (owner) {\n        if (!owner._listeningTo[this._id]) {\n          owner._listeningTo[this._id] = {};\n        }\n\n        if (!owner._listeningTo[this._id][event]) {\n          owner._listeningTo[this._id][event] = [];\n        }\n\n        owner._listeningTo[this._id][event].push({\n          other: this,\n          callback: callback\n        });\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this = this;\n\n      var process = function process(event) {\n        var array1 = _this._events[event];\n        var index1 = 0;\n\n        while (index1 < array1.length) {\n          var item1 = array1[index1];\n\n          if ((callback == null || item1.callback === callback) && (owner == null || item1.owner === owner)) {\n            array1.splice(index1, 1);\n\n            if (owner && owner._listeningTo[_this._id] && owner._listeningTo[_this._id][event]) {\n              var array2 = owner._listeningTo[_this._id][event];\n              var index2 = 0;\n\n              while (index2 < array2.length) {\n                var item2 = array2[index2];\n\n                if (item2.other === _this && item2.callback === callback) {\n                  array2.splice(index2, 1);\n\n                  if (event && callback) {\n                    break;\n                  }\n\n                  continue;\n                }\n\n                index2++;\n              }\n            }\n\n            if (event && callback) {\n              break;\n            }\n\n            continue;\n          }\n\n          index1++;\n        }\n\n        if (_this._events[event].length === 0) {\n          delete _this._events[event];\n        }\n      };\n\n      if (event) {\n        if (this._events[event]) {\n          process(event);\n        }\n      } else {\n        for (var key in this._events) {\n          process(key);\n        }\n      }\n\n      return this;\n    },\n    trigger: function trigger(event) {\n      if (this._events[event]) {\n        var array = _toConsumableArray(this._events[event]);\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var _item$callback;\n\n          var item = array[index];\n\n          (_item$callback = item.callback).call.apply(_item$callback, [this].concat(args));\n        }\n      }\n\n      return this;\n    },\n    listenTo: function listenTo(other, event, callback) {\n      other.on(event, callback, this);\n      return this;\n    },\n    stopListeningTo: function stopListeningTo(other, event, callback) {\n      var _this2 = this;\n\n      var process2 = function process2(id, event) {\n        var array = _toConsumableArray(_this2._listeningTo[id][event]);\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var item = array[index];\n          item.other.off(event, callback, _this2);\n        }\n      };\n\n      var process1 = function process1(id) {\n        var listentingTo = _this2._listeningTo[id];\n\n        if (event) {\n          if (listentingTo[event]) {\n            process2(id, event);\n          }\n        } else {\n          for (var key in listentingTo) {\n            process2(id, key);\n          }\n        }\n      };\n\n      if (other) {\n        if (this._listeningTo[other._id]) {\n          process1(other._id);\n        }\n      } else {\n        for (var key in this._listeningTo) {\n          process1(key);\n        }\n      }\n\n      return this;\n    }\n  };\n  var propertyDescriptors = {\n    _id: {\n      writable: true\n    },\n    _events: {\n      writable: true\n    },\n    _listeningTo: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: methods.initialize\n    },\n    terminate: {\n      enumerable: true,\n      value: methods.terminate\n    },\n    on: {\n      enumerable: true,\n      value: methods.on\n    },\n    off: {\n      enumerable: true,\n      value: methods.off\n    },\n    trigger: {\n      enumerable: true,\n      value: methods.trigger\n    },\n    listenTo: {\n      enumerable: true,\n      value: methods.listenTo\n    },\n    stopListeningTo: {\n      enumerable: true,\n      value: methods.stopListeningTo\n    }\n  };\n  var eventTargetMethods = Object.assign({}, methods, {\n    initialize: function initialize() {\n      var eventTarget = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n      this._eventTarget = eventTarget;\n      this._listeners = {};\n      return methods.initialize.call(this);\n    },\n    on: function on(event, callback, owner) {\n      var _this3 = this;\n\n      methods.on.call(this, event, callback, owner);\n\n      if (!this._listeners[event]) {\n        this._listeners[event] = function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return void _this3.trigger.apply(_this3, [event].concat(args));\n        };\n\n        this._eventTarget.addEventListener(event, this._listeners[event]);\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this4 = this;\n\n      methods.off.call(this, event, callback, owner);\n\n      var process = function process(event) {\n        _this4._eventTarget.removeEventListener(event, _this4._listeners[event]);\n\n        _this4._listeners[event] = null;\n      };\n\n      if (event) {\n        if (this._listeners[event] && (!this._events[event] || this._events[event].length === 0)) {\n          process(event);\n        }\n      } else {\n        for (var key in this._listeners) {\n          if (!this._events[event] || this._events[event].length === 0) {\n            process(key);\n          }\n        }\n      }\n\n      return this;\n    }\n  });\n  var eventTargetPropertyDescriptors = Object.assign({}, propertyDescriptors, {\n    _listeners: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: eventTargetMethods.initialize\n    },\n    on: {\n      enumerable: true,\n      value: eventTargetMethods.on\n    },\n    off: {\n      enumerable: true,\n      value: eventTargetMethods.off\n    }\n  });\n\n  function factory(obj) {\n    if (obj instanceof EventTarget) {\n      return Object.defineProperties(obj, eventTargetPropertyDescriptors);\n    }\n\n    return Object.defineProperties(obj, propertyDescriptors);\n  }\n\n  return {\n    methods: methods,\n    propertyDescriptors: propertyDescriptors,\n    eventTargetMethods: eventTargetMethods,\n    eventTargetPropertyDescriptors: eventTargetPropertyDescriptors,\n    factory: factory\n  };\n}();\n/* exported Eventful */"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","Eventful","nextId","IdSequence","next","methods","initialize","this","_id","_events","_listeningTo","terminate","off","stopListeningTo","trigger","on","event","callback","owner","push","other","process","array1","_this","index1","item1","splice","array2","index2","item2","key","array","_len","arguments","args","_key","_item$callback","index","apply","concat","listenTo","process2","id","_this2","process1","listentingTo","propertyDescriptors","writable","enumerable","value","eventTargetMethods","assign","_eventTarget","undefined","_listeners","_this3","_len2","_key2","addEventListener","_this4","removeEventListener","eventTargetPropertyDescriptors","factory","obj","EventTarget","defineProperties"],"mappings":"aAEA,SAASA,mBAAmBC,GAAO,OAAOC,mBAAmBD,IAAQE,iBAAiBF,IAAQG,4BAA4BH,IAAQI,qBAElI,SAASA,qBAAuB,MAAM,IAAIC,UAAU,wIAEpD,SAASF,4BAA4BG,EAAGC,GAAU,GAAKD,EAAL,CAAgB,GAAiB,iBAANA,EAAgB,OAAOE,kBAAkBF,EAAGC,GAAS,IAAIE,EAAIC,OAAOC,UAAUC,SAASC,KAAKP,GAAGQ,MAAM,GAAI,GAAiE,MAAU,SAAlCL,EAA3B,WAANA,GAAkBH,EAAES,YAAiBT,EAAES,YAAYC,KAAUP,IAAqB,QAANA,EAAoBQ,MAAMC,KAAKZ,GAAc,cAANG,GAAqB,2CAA2CU,KAAKV,GAAWD,kBAAkBF,EAAGC,QAAzG,GAE7S,SAASL,iBAAiBkB,GAAQ,GAAsB,oBAAXC,QAAmD,MAAzBD,EAAKC,OAAOC,WAA2C,MAAtBF,EAAK,cAAuB,OAAOH,MAAMC,KAAKE,GAEtJ,SAASnB,mBAAmBD,GAAO,GAAIiB,MAAMM,QAAQvB,GAAM,OAAOQ,kBAAkBR,GAEpF,SAASQ,kBAAkBR,EAAKwB,IAAkB,MAAPA,GAAeA,EAAMxB,EAAIyB,UAAQD,EAAMxB,EAAIyB,QAAQ,IAAK,IAAIC,EAAI,EAAGC,EAAO,IAAIV,MAAMO,GAAME,EAAIF,EAAKE,IAAOC,EAAKD,GAAK1B,EAAI0B,GAAM,OAAOC,EAGhL,IAAIC,SAAW,WACb,IACIC,EADcC,WACOC,KACrBC,EAAU,CACZC,WAAY,WAIV,OAHAC,KAAKC,IAAMN,EAAO,aAClBK,KAAKE,QAAU,GACfF,KAAKG,aAAe,GACbH,MAETI,UAAW,WACTJ,KAAKK,MACLL,KAAKM,kBACLN,KAAKO,QAAQ,cAEfC,GAAI,SAAYC,EAAOC,EAAUC,GAyB/B,OAxBKX,KAAKE,QAAQO,KAChBT,KAAKE,QAAQO,GAAS,IAGxBT,KAAKE,QAAQO,GAAOG,KAAK,CACvBF,SAAUA,EACVC,MAAOA,IAGLA,IACGA,EAAMR,aAAaH,KAAKC,OAC3BU,EAAMR,aAAaH,KAAKC,KAAO,IAG5BU,EAAMR,aAAaH,KAAKC,KAAKQ,KAChCE,EAAMR,aAAaH,KAAKC,KAAKQ,GAAS,IAGxCE,EAAMR,aAAaH,KAAKC,KAAKQ,GAAOG,KAAK,CACvCC,MAAOb,KACPU,SAAUA,KAIPV,MAETK,IAAK,SAAaI,EAAOC,EAAUC,GAGnB,SAAVG,EAA2BL,GAI7B,IAHA,IAAIM,EAASC,EAAMd,QAAQO,GACvBQ,EAAS,EAENA,EAASF,EAAOxB,QAAQ,CAC7B,IAAI2B,EAAQH,EAAOE,GAEnB,GAAiB,MAAZP,GAAoBQ,EAAMR,WAAaA,GAAuB,MAATC,GAAiBO,EAAMP,QAAUA,EA+B3FM,QA/BA,CAGE,GAFAF,EAAOI,OAAOF,EAAQ,GAElBN,GAASA,EAAMR,aAAaa,EAAMf,MAAQU,EAAMR,aAAaa,EAAMf,KAAKQ,GAI1E,IAHA,IAAIW,EAAST,EAAMR,aAAaa,EAAMf,KAAKQ,GACvCY,EAAS,EAENA,EAASD,EAAO7B,QAAQ,CAC7B,IAAI+B,EAAQF,EAAOC,GAEnB,GAAIC,EAAMT,QAAUG,GAASM,EAAMZ,WAAaA,EAUhDW,SAPE,GAFAD,EAAOD,OAAOE,EAAQ,GAElBZ,GAASC,EACX,MAUR,GAAID,GAASC,EACX,OAS8B,IAAhCM,EAAMd,QAAQO,GAAOlB,eAChByB,EAAMd,QAAQO,GA5CzB,IAAIO,EAAQhB,KAgDZ,GAAIS,EACET,KAAKE,QAAQO,IACfK,EAAQL,QAGV,IAAK,IAAIc,KAAOvB,KAAKE,QACnBY,EAAQS,GAIZ,OAAOvB,MAETO,QAAS,SAAiBE,GACxB,GAAIT,KAAKE,QAAQO,GAAQ,CAGvB,IAFA,IAAIe,EAAQ3D,mBAAmBmC,KAAKE,QAAQO,IAEnCgB,EAAOC,UAAUnC,OAAQoC,EAAO,IAAI5C,MAAa,EAAP0C,EAAWA,EAAO,EAAI,GAAIG,EAAO,EAAGA,EAAOH,EAAMG,IAClGD,EAAKC,EAAO,GAAKF,UAAUE,GAG7B,IAAK,IACCC,EADGC,EAAQ,EAAGvC,EAASiC,EAAMjC,OAAQuC,EAAQvC,EAAQuC,KAKxDD,EAFUL,EAAMM,GAEMpB,UAAU/B,KAAKoD,MAAMF,EAAgB,CAAC7B,MAAMgC,OAAOL,IAI9E,OAAO3B,MAETiC,SAAU,SAAkBpB,EAAOJ,EAAOC,GAExC,OADAG,EAAML,GAAGC,EAAOC,EAAUV,MACnBA,MAETM,gBAAiB,SAAyBO,EAAOJ,EAAOC,GAGvC,SAAXwB,EAA6BC,EAAI1B,GAGnC,IAFA,IAAIe,EAAQ3D,mBAAmBuE,EAAOjC,aAAagC,GAAI1B,IAE9CqB,EAAQ,EAAGvC,EAASiC,EAAMjC,OAAQuC,EAAQvC,EAAQuC,IAC9CN,EAAMM,GACZjB,MAAMR,IAAII,EAAOC,EAAU0B,GAIrB,SAAXC,EAA6BF,GAC/B,IAAIG,EAAeF,EAAOjC,aAAagC,GAEvC,GAAI1B,EACE6B,EAAa7B,IACfyB,EAASC,EAAI1B,QAGf,IAAK,IAAIc,KAAOe,EACdJ,EAASC,EAAIZ,GApBnB,IAAIa,EAASpC,KAyBb,GAAIa,EACEb,KAAKG,aAAaU,EAAMZ,MAC1BoC,EAASxB,EAAMZ,UAGjB,IAAK,IAAIsB,KAAOvB,KAAKG,aACnBkC,EAASd,GAIb,OAAOvB,OAGPuC,EAAsB,CACxBtC,IAAK,CACHuC,UAAU,GAEZtC,QAAS,CACPsC,UAAU,GAEZrC,aAAc,CACZqC,UAAU,GAEZzC,WAAY,CACV0C,YAAY,EACZC,MAAO5C,EAAQC,YAEjBK,UAAW,CACTqC,YAAY,EACZC,MAAO5C,EAAQM,WAEjBI,GAAI,CACFiC,YAAY,EACZC,MAAO5C,EAAQU,IAEjBH,IAAK,CACHoC,YAAY,EACZC,MAAO5C,EAAQO,KAEjBE,QAAS,CACPkC,YAAY,EACZC,MAAO5C,EAAQS,SAEjB0B,SAAU,CACRQ,YAAY,EACZC,MAAO5C,EAAQmC,UAEjB3B,gBAAiB,CACfmC,YAAY,EACZC,MAAO5C,EAAQQ,kBAGfqC,EAAqBnE,OAAOoE,OAAO,GAAI9C,EAAS,CAClDC,WAAY,WAIV,OAFAC,KAAK6C,aADgC,EAAnBnB,UAAUnC,aAA+BuD,IAAjBpB,UAAU,GAAmBA,UAAU,GAAK1B,KAEtFA,KAAK+C,WAAa,GACXjD,EAAQC,WAAWpB,KAAKqB,OAEjCQ,GAAI,SAAYC,EAAOC,EAAUC,GAC/B,IAAIqC,EAAShD,KAgBb,OAdAF,EAAQU,GAAG7B,KAAKqB,KAAMS,EAAOC,EAAUC,GAElCX,KAAK+C,WAAWtC,KACnBT,KAAK+C,WAAWtC,GAAS,WACvB,IAAK,IAAIwC,EAAQvB,UAAUnC,OAAQoC,EAAO,IAAI5C,MAAMkE,GAAQC,EAAQ,EAAGA,EAAQD,EAAOC,IACpFvB,EAAKuB,GAASxB,UAAUwB,GAGdF,EAAOzC,QAAQwB,MAAMiB,EAAQ,CAACvC,GAAOuB,OAAOL,KAG1D3B,KAAK6C,aAAaM,iBAAiB1C,EAAOT,KAAK+C,WAAWtC,KAGrDT,MAETK,IAAK,SAAaI,EAAOC,EAAUC,GACjC,IAAIyC,EAASpD,KAEbF,EAAQO,IAAI1B,KAAKqB,KAAMS,EAAOC,EAAUC,GAE1B,SAAVG,EAA2BL,GAC7B2C,EAAOP,aAAaQ,oBAAoB5C,EAAO2C,EAAOL,WAAWtC,IAEjE2C,EAAOL,WAAWtC,GAAS,KAG7B,GAAIA,GACET,KAAK+C,WAAWtC,IAAYT,KAAKE,QAAQO,IAAyC,IAA/BT,KAAKE,QAAQO,GAAOlB,QACzEuB,EAAQL,QAGV,IAAK,IAAIc,KAAOvB,KAAK+C,WACd/C,KAAKE,QAAQO,IAAyC,IAA/BT,KAAKE,QAAQO,GAAOlB,QAC9CuB,EAAQS,GAKd,OAAOvB,QAGPsD,EAAiC9E,OAAOoE,OAAO,GAAIL,EAAqB,CAC1EQ,WAAY,CACVP,UAAU,GAEZzC,WAAY,CACV0C,YAAY,EACZC,MAAOC,EAAmB5C,YAE5BS,GAAI,CACFiC,YAAY,EACZC,MAAOC,EAAmBnC,IAE5BH,IAAK,CACHoC,YAAY,EACZC,MAAOC,EAAmBtC,OAY9B,MAAO,CACLP,QAASA,EACTyC,oBAAqBA,EACrBI,mBAAoBA,EACpBW,+BAAgCA,EAChCC,QAbF,SAAiBC,GACf,OAAIA,aAAeC,YACVjF,OAAOkF,iBAAiBF,EAAKF,GAG/B9E,OAAOkF,iBAAiBF,EAAKjB,KAvRzB"}