{"version":3,"file":"eventful.min.js","sources":["eventful.min.js"],"sourcesContent":["\"use strict\";\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/* global IdSequence */\nvar Eventful = function () {\n  var _IdSequence = IdSequence,\n      nextId = _IdSequence.next;\n  var methods = {\n    initialize: function initialize() {\n      this._id = nextId('eventful-');\n      this._events = {};\n      this._listeningTo = {};\n      return this;\n    },\n    terminate: function terminate() {\n      this.off();\n      this.stopListeningTo();\n    },\n    on: function on(event, callback, owner) {\n      if (!this._events[event]) {\n        this._events[event] = [];\n      }\n\n      this._events[event].push({\n        callback: callback,\n        owner: owner\n      });\n\n      if (owner) {\n        if (!owner._listeningTo[this._id]) {\n          owner._listeningTo[this._id] = {};\n        }\n\n        if (!owner._listeningTo[this._id][event]) {\n          owner._listeningTo[this._id][event] = [];\n        }\n\n        owner._listeningTo[this._id][event].push({\n          other: this,\n          callback: callback\n        });\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this = this;\n\n      var process = function process(event) {\n        var array1 = _this._events[event];\n        var index1 = 0;\n\n        while (index1 < array1.length) {\n          var item1 = array1[index1];\n\n          if ((callback == null || item1.callback === callback) && (owner == null || item1.owner === owner)) {\n            array1.splice(index1, 1);\n\n            if (owner && owner._listeningTo[_this._id] && owner._listeningTo[_this._id][event]) {\n              var array2 = owner._listeningTo[_this._id][event];\n              var index2 = 0;\n\n              while (index2 < array2.length) {\n                var item2 = array2[index2];\n\n                if (item2.other === _this && item2.callback === callback) {\n                  array2.splice(index2, 1);\n\n                  if (event && callback) {\n                    break;\n                  }\n\n                  continue;\n                }\n\n                index2++;\n              }\n            }\n\n            if (event && callback) {\n              break;\n            }\n\n            continue;\n          }\n\n          index1++;\n        }\n\n        if (_this._events[event].length === 0) {\n          delete _this._events[event];\n        }\n      };\n\n      if (event) {\n        if (this._events[event]) {\n          process(event);\n        }\n      } else {\n        for (var key in this._events) {\n          process(key);\n        }\n      }\n\n      return this;\n    },\n    trigger: function trigger(event) {\n      if (this._events[event]) {\n        var array = _toConsumableArray(this._events[event]);\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var _item$callback;\n\n          var item = array[index];\n\n          (_item$callback = item.callback).call.apply(_item$callback, [this].concat(args));\n        }\n      }\n\n      return this;\n    },\n    listenTo: function listenTo(other, event, callback) {\n      other.on(event, callback, this);\n      return this;\n    },\n    stopListeningTo: function stopListeningTo(other, event, callback) {\n      var _this2 = this;\n\n      var process2 = function process2(id, event) {\n        var array = _toConsumableArray(_this2._listeningTo[id][event]);\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var item = array[index];\n          item.other.off(event, callback, _this2);\n        }\n      };\n\n      var process1 = function process1(id) {\n        var listentingTo = _this2._listeningTo[id];\n\n        if (event) {\n          if (listentingTo[event]) {\n            process2(id, event);\n          }\n        } else {\n          for (var key in listentingTo) {\n            process2(id, key);\n          }\n        }\n      };\n\n      if (other) {\n        if (this._listeningTo[other._id]) {\n          process1(other._id);\n        }\n      } else {\n        for (var key in this._listeningTo) {\n          process1(key);\n        }\n      }\n\n      return this;\n    }\n  };\n  var propertyDescriptors = {\n    _id: {\n      writable: true\n    },\n    _events: {\n      writable: true\n    },\n    _listeningTo: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: methods.initialize\n    },\n    terminate: {\n      enumerable: true,\n      value: methods.terminate\n    },\n    on: {\n      enumerable: true,\n      value: methods.on\n    },\n    off: {\n      enumerable: true,\n      value: methods.off\n    },\n    trigger: {\n      enumerable: true,\n      value: methods.trigger\n    },\n    listenTo: {\n      enumerable: true,\n      value: methods.listenTo\n    },\n    stopListeningTo: {\n      enumerable: true,\n      value: methods.stopListeningTo\n    }\n  };\n  var targetMethods = Object.assign({}, methods, {\n    initialize: function initialize() {\n      var target = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n      methods.initialize.call(this);\n      this._target = target;\n      this._listeners = {};\n      return this;\n    },\n    on: function on(event, callback, owner) {\n      var _this3 = this;\n\n      methods.on.call(this, event, callback, owner);\n\n      if (!this._listeners[event]) {\n        this._listeners[event] = function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return void _this3.trigger.apply(_this3, [event].concat(args));\n        };\n\n        this._target.addEventListener(event, this._listeners[event]);\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this4 = this;\n\n      methods.off.call(this, event, callback, owner);\n\n      var process = function process(event) {\n        _this4._target.removeEventListener(event, _this4._listeners[event]);\n\n        _this4._listeners[event] = null;\n      };\n\n      if (event) {\n        if (this._listeners[event] && (!this._events[event] || this._events[event].length === 0)) {\n          process(event);\n        }\n      } else {\n        for (var key in this._listeners) {\n          if (!this._events[event] || this._events[event].length === 0) {\n            process(key);\n          }\n        }\n      }\n\n      return this;\n    }\n  });\n  var targetPropertyDescriptors = Object.assign({}, propertyDescriptors, {\n    _target: {\n      writable: true\n    },\n    _listeners: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: targetMethods.initialize\n    },\n    on: {\n      enumerable: true,\n      value: targetMethods.on\n    },\n    off: {\n      enumerable: true,\n      value: targetMethods.off\n    }\n  });\n  return {\n    methods: methods,\n    propertyDescriptors: propertyDescriptors,\n    targetMethods: targetMethods,\n    targetPropertyDescriptors: targetPropertyDescriptors\n  };\n}();\n/* exported Eventful */"],"names":["_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","Eventful","nextId","IdSequence","next","methods","initialize","this","_id","_events","_listeningTo","terminate","off","stopListeningTo","on","event","callback","owner","push","other","process","array1","_this","index1","item1","splice","array2","index2","item2","key","trigger","array","_len","arguments","args","_key","_item$callback","index","apply","concat","listenTo","process2","id","_this2","process1","listentingTo","propertyDescriptors","writable","enumerable","value","targetMethods","assign","target","undefined","_target","_listeners","_this3","_len2","_key2","addEventListener","_this4","removeEventListener","targetPropertyDescriptors"],"mappings":"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"}