{"version":3,"file":"eventful.min.js","sources":["eventful.min.js"],"sourcesContent":["\"use strict\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\n/* global IdSequence */\nvar Eventful = function () {\n  var _IdSequence = IdSequence,\n      nextId = _IdSequence.next;\n  var methods = {\n    initialize: function initialize() {\n      var context = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n      this._context = context;\n      this._id = nextId('eventful-');\n      this._events = {};\n      this._listeningTo = {};\n      return this;\n    },\n    terminate: function terminate() {\n      this.off();\n      this.stopListeningTo();\n      this.trigger('terminate');\n    },\n    on: function on(event, callback, owner) {\n      if (!this._events[event]) {\n        this._events[event] = [];\n      }\n\n      this._events[event].push({\n        callback: callback,\n        owner: owner\n      });\n\n      if (owner) {\n        if (!owner._listeningTo[this._id]) {\n          owner._listeningTo[this._id] = {};\n        }\n\n        if (!owner._listeningTo[this._id][event]) {\n          owner._listeningTo[this._id][event] = [];\n        }\n\n        owner._listeningTo[this._id][event].push({\n          other: this,\n          callback: callback\n        });\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this = this;\n\n      var process = function process(event) {\n        var array1 = _this._events[event];\n        var index1 = 0;\n\n        while (index1 < array1.length) {\n          var item1 = array1[index1];\n\n          if ((callback == null || item1.callback === callback) && (owner == null || item1.owner === owner)) {\n            array1.splice(index1, 1);\n\n            if (owner && owner._listeningTo[_this._id] && owner._listeningTo[_this._id][event]) {\n              var array2 = owner._listeningTo[_this._id][event];\n              var index2 = 0;\n\n              while (index2 < array2.length) {\n                var item2 = array2[index2];\n\n                if (item2.other === _this && item2.callback === callback) {\n                  array2.splice(index2, 1);\n\n                  if (event && callback) {\n                    break;\n                  }\n\n                  continue;\n                }\n\n                index2++;\n              }\n            }\n\n            if (event && callback) {\n              break;\n            }\n\n            continue;\n          }\n\n          index1++;\n        }\n\n        if (_this._events[event].length === 0) {\n          delete _this._events[event];\n        }\n      };\n\n      if (event) {\n        if (this._events[event]) {\n          process(event);\n        }\n      } else {\n        for (var key in this._events) {\n          process(key);\n        }\n      }\n\n      return this;\n    },\n    trigger: function trigger(event) {\n      if (this._events[event]) {\n        var array = _toConsumableArray(this._events[event]);\n\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var _item$callback;\n\n          var item = array[index];\n\n          (_item$callback = item.callback).call.apply(_item$callback, [this].concat(args));\n        }\n      }\n\n      return this;\n    },\n    listenTo: function listenTo(other, event, callback) {\n      other.on(event, callback, this);\n      return this;\n    },\n    stopListeningTo: function stopListeningTo(other, event, callback) {\n      var _this2 = this;\n\n      var process2 = function process2(id, event) {\n        var array = _toConsumableArray(_this2._listeningTo[id][event]);\n\n        for (var index = 0, length = array.length; index < length; index++) {\n          var item = array[index];\n          item.other.off(event, callback, _this2);\n        }\n      };\n\n      var process1 = function process1(id) {\n        var listeningTo = _this2._listeningTo[id];\n\n        if (event) {\n          if (listeningTo[event]) {\n            process2(id, event);\n          }\n        } else {\n          for (var key in listeningTo) {\n            process2(id, key);\n          }\n        }\n      };\n\n      if (other) {\n        if (this._listeningTo[other._id]) {\n          process1(other._id);\n        }\n      } else {\n        for (var key in this._listeningTo) {\n          process1(key);\n        }\n      }\n\n      return this;\n    }\n  };\n  var propertyDescriptors = {\n    _context: {\n      writable: true\n    },\n    _id: {\n      writable: true\n    },\n    _events: {\n      writable: true\n    },\n    _listeningTo: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        return methods.initialize.call(this);\n      }\n    },\n    terminate: {\n      enumerable: true,\n      value: methods.terminate\n    },\n    on: {\n      enumerable: true,\n      value: methods.on\n    },\n    off: {\n      enumerable: true,\n      value: methods.off\n    },\n    trigger: {\n      enumerable: true,\n      value: methods.trigger\n    },\n    listenTo: {\n      enumerable: true,\n      value: methods.listenTo\n    },\n    stopListeningTo: {\n      enumerable: true,\n      value: methods.stopListeningTo\n    }\n  };\n  var eventTargetMethods = Object.assign({}, methods, {\n    initialize: function initialize(context) {\n      this._listeners = {};\n      return methods.initialize.call(this, context);\n    },\n    on: function on(event, callback, owner) {\n      var _this3 = this;\n\n      methods.on.call(this, event, callback, owner);\n\n      if (!this._listeners[event]) {\n        this._listeners[event] = function () {\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          return void _this3.trigger.apply(_this3, [event].concat(args));\n        };\n\n        this._context.addEventListener(event, this._listeners[event]);\n      }\n\n      return this;\n    },\n    off: function off(event, callback, owner) {\n      var _this4 = this;\n\n      methods.off.call(this, event, callback, owner);\n\n      var process = function process(event) {\n        _this4._context.removeEventListener(event, _this4._listeners[event]);\n\n        _this4._listeners[event] = null;\n      };\n\n      if (event) {\n        if (this._listeners[event] && (!this._events[event] || this._events[event].length === 0)) {\n          process(event);\n        }\n      } else {\n        for (var key in this._listeners) {\n          if (!this._events[event] || this._events[event].length === 0) {\n            process(key);\n          }\n        }\n      }\n\n      return this;\n    }\n  });\n  var eventTargetPropertyDescriptors = Object.assign({}, propertyDescriptors, {\n    _listeners: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        return eventTargetMethods.initialize.call(this);\n      }\n    },\n    on: {\n      enumerable: true,\n      value: eventTargetMethods.on\n    },\n    off: {\n      enumerable: true,\n      value: eventTargetMethods.off\n    }\n  });\n\n  function wrap(context) {\n    if (context instanceof EventTarget) {\n      return _objectSpread({}, eventTargetMethods).initialize(context);\n    }\n\n    return _objectSpread({}, methods).initialize(context);\n  }\n\n  function implement(context) {\n    if (context instanceof EventTarget) {\n      return Object.defineProperties(context, eventTargetPropertyDescriptors).initialize();\n    }\n\n    return Object.defineProperties(context, propertyDescriptors).initialize();\n  }\n\n  return {\n    methods: methods,\n    propertyDescriptors: propertyDescriptors,\n    eventTargetMethods: eventTargetMethods,\n    eventTargetPropertyDescriptors: eventTargetPropertyDescriptors,\n    wrap: wrap,\n    implement: implement\n  };\n}();\n/* exported Eventful */"],"names":["ownKeys","object","enumerableOnly","symbols","keys","Object","getOwnPropertySymbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","Eventful","nextId","IdSequence","next","methods","initialize","this","_context","undefined","_id","_events","_listeningTo","terminate","off","stopListeningTo","trigger","on","event","callback","owner","other","process","array1","_this","index1","item1","splice","array2","index2","item2","array","_len","args","_key","_item$callback","index","concat","listenTo","process2","id","_this2","process1","listeningTo","propertyDescriptors","eventTargetMethods","assign","context","_listeners","_this3","_len2","_key2","addEventListener","_this4","removeEventListener","eventTargetPropertyDescriptors","wrap","EventTarget","implement"],"mappings":"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"}