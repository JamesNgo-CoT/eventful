"use strict";function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Eventful=function(){var e=IdSequence.next,s={initialize:function(){return this._context=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this,this._id=e("eventful-"),this._events={},this._listeningTo={},this},terminate:function(){this.off(),this.stopListeningTo(),this.trigger("terminate")},on:function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,owner:n}),n&&(n._listeningTo[this._id]||(n._listeningTo[this._id]={}),n._listeningTo[this._id][e]||(n._listeningTo[this._id][e]=[]),n._listeningTo[this._id][e].push({other:this,callback:t})),this},off:function(e,a,l){function t(e){for(var t=u._events[e],n=0;n<t.length;){var r=t[n];if(null!=a&&r.callback!==a||null!=l&&r.owner!==l)n++;else{if(t.splice(n,1),l&&l._listeningTo[u._id]&&l._listeningTo[u._id][e])for(var i=l._listeningTo[u._id][e],o=0;o<i.length;){var s=i[o];if(s.other!==u||s.callback!==a)o++;else if(i.splice(o,1),e&&a)break}if(e&&a)break}}0===u._events[e].length&&delete u._events[e]}var u=this;if(e)this._events[e]&&t(e);else for(var n in this._events)t(n);return this},trigger:function(e){if(this._events[e]){for(var t=_toConsumableArray(this._events[e]),n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o,s=0,a=t.length;s<a;s++)(o=t[s].callback).call.apply(o,[this].concat(r))}return this},listenTo:function(e,t,n){return e.on(t,n,this),this},stopListeningTo:function(e,r,o){function i(e,t){for(var n=_toConsumableArray(s._listeningTo[e][t]),r=0,i=n.length;r<i;r++)n[r].other.off(t,o,s)}function t(e){var t=s._listeningTo[e];if(r)t[r]&&i(e,r);else for(var n in t)i(e,n)}var s=this;if(e)this._listeningTo[e._id]&&t(e._id);else for(var n in this._listeningTo)t(n);return this}},t={_context:{writable:!0},_id:{writable:!0},_events:{writable:!0},_listeningTo:{writable:!0},initialize:{enumerable:!0,value:function(){return s.initialize.call(this)}},terminate:{enumerable:!0,value:s.terminate},on:{enumerable:!0,value:s.on},off:{enumerable:!0,value:s.off},trigger:{enumerable:!0,value:s.trigger},listenTo:{enumerable:!0,value:s.listenTo},stopListeningTo:{enumerable:!0,value:s.stopListeningTo}},n=Object.assign({},s,{initialize:function(e){return this._listeners={},s.initialize.call(this,e)},on:function(r,e,t){var i=this;return s.on.call(this,r,e,t),this._listeners[r]||(this._listeners[r]=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.trigger.apply(i,[r].concat(t))},this._context.addEventListener(r,this._listeners[r])),this},off:function(e,t,n){var r=this;s.off.call(this,e,t,n);function i(e){r._context.removeEventListener(e,r._listeners[e]),r._listeners[e]=null}if(e)!this._listeners[e]||this._events[e]&&0!==this._events[e].length||i(e);else for(var o in this._listeners)this._events[e]&&0!==this._events[e].length||i(o);return this}}),r=Object.assign({},t,{_listeners:{writable:!0},initialize:{enumerable:!0,value:function(){return n.initialize.call(this)}},on:{enumerable:!0,value:n.on},off:{enumerable:!0,value:n.off}});return{methods:s,propertyDescriptors:t,eventTargetMethods:n,eventTargetPropertyDescriptors:r,wrap:function(e){return(e instanceof EventTarget?_objectSpread({},n):_objectSpread({},s)).initialize(e)},implement:function(e){return(e instanceof EventTarget?Object.defineProperties(e,r):Object.defineProperties(e,t)).initialize()}}}();
//# sourceMappingURL=eventful.min.js.map
