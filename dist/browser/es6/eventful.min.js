const Eventful=(()=>{const{next:e}=IdSequence,t={initialize(){return this._id=e("eventful-"),this._events={},this._listeningTo={},this},terminate(){this.off(),this.stopListeningTo(),this.trigger("terminate")},on(e,t,i){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,owner:i}),i&&(i._listeningTo[this._id]||(i._listeningTo[this._id]={}),i._listeningTo[this._id][e]||(i._listeningTo[this._id][e]=[]),i._listeningTo[this._id][e].push({other:this,callback:t})),this},off(e,t,i){const s=e=>{const s=this._events[e];let n=0;for(;n<s.length;){const l=s[n];if(null!=t&&l.callback!==t||null!=i&&l.owner!==i)n++;else{if(s.splice(n,1),i&&i._listeningTo[this._id]&&i._listeningTo[this._id][e]){const s=i._listeningTo[this._id][e];let n=0;for(;n<s.length;){const i=s[n];if(i.other!==this||i.callback!==t)n++;else if(s.splice(n,1),e&&t)break}}if(e&&t)break}}0===this._events[e].length&&delete this._events[e]};if(e)this._events[e]&&s(e);else for(const e in this._events)s(e);return this},trigger(e,...t){if(this._events[e]){const i=[...this._events[e]];for(let e=0,s=i.length;e<s;e++){i[e].callback.call(this,...t)}}return this},listenTo(e,t,i){return e.on(t,i,this),this},stopListeningTo(e,t,i){const s=(e,t)=>{const s=[...this._listeningTo[e][t]];for(let e=0,n=s.length;e<n;e++){s[e].other.off(t,i,this)}},n=e=>{const i=this._listeningTo[e];if(t)i[t]&&s(e,t);else for(const t in i)s(e,t)};if(e)this._listeningTo[e._id]&&n(e._id);else for(const e in this._listeningTo)n(e);return this}},i={_id:{writable:!0},_events:{writable:!0},_listeningTo:{writable:!0},initialize:{enumerable:!0,value:t.initialize},terminate:{enumerable:!0,value:t.terminate},on:{enumerable:!0,value:t.on},off:{enumerable:!0,value:t.off},trigger:{enumerable:!0,value:t.trigger},listenTo:{enumerable:!0,value:t.listenTo},stopListeningTo:{enumerable:!0,value:t.stopListeningTo}},s=Object.assign({},t,{initialize(){return t.initialize.call(this),this._listeners={},this},on(e,i,s){return t.on.call(this,e,i,s),this._listeners[e]||(this._listeners[e]=(...t)=>{this.trigger(e,...t)},this.addEventListener(e,this._listeners[e])),this},off(e,i,s){t.off.call(this,e,i,s);const n=e=>{this.removeEventListener(e,this._listeners[e]),this._listeners[e]=null};if(e)!this._listeners[e]||this._events[e]&&0!==this._events[e].length||n(e);else for(const t in this._listeners)this._events[e]&&0!==this._events[e].length||n(t);return this}}),n=Object.assign({},i,{_listeners:{writable:!0},initialize:{enumerable:!0,value:s.initialize},on:{enumerable:!0,value:s.on},off:{enumerable:!0,value:s.off}});return{methods:t,propertyDescriptors:i,eventTargetMethods:s,eventTargetPropertyDescriptors:n,factory:function(e){return e instanceof EventTarget?Object.defineProperties(e,n):Object.defineProperties(e,i)}}})();
//# sourceMappingURL=eventful.min.js.map
