{"version":3,"file":"eventful.min.js","sources":["eventful.min.js"],"sourcesContent":["\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar Eventful = function () {\n  var idCounter = 0;\n  var propertyDescriptors = {\n    _id: {\n      writable: true\n    },\n    _events: {\n      writable: true\n    },\n    _listeningTo: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        this._id = \"eventful\".concat(idCounter++);\n        this._events = {};\n        this._listeningTo = {};\n        return this;\n      }\n    },\n    on: {\n      enumerable: true,\n      value: function value(event, handler, owner) {\n        if (!this._events[event]) {\n          this._events[event] = [];\n        }\n\n        this._events[event].push({\n          handler: handler,\n          owner: owner\n        });\n\n        if (owner) {\n          if (!owner._listeningTo[this._id]) {\n            owner._listeningTo[this._id] = {\n              ref: this,\n              handlers: []\n            };\n          }\n\n          owner._listeningTo[this._id].handlers.push(handler);\n        }\n\n        return this;\n      }\n    },\n    off: {\n      enumerable: true,\n      value: function value(event, handler, owner) {\n        var _this = this;\n\n        var process = function process(key) {\n          var index = 0;\n\n          while (index < _this._events[key].length) {\n            var _this$_events$key$ind = _this._events[key][index],\n                thisHandler = _this$_events$key$ind.handler,\n                thisOwner = _this$_events$key$ind.owner;\n\n            if ((!handler || handler === thisHandler) && (!owner || owner === thisOwner)) {\n              if (thisOwner && thisOwner._listeningTo && thisOwner._listeningTo[_this._id]) {\n                var handlerIndex = thisOwner._listeningTo[_this._id].handlers.indexOf(thisHandler);\n\n                if (handlerIndex !== -1) {\n                  thisOwner._listeningTo[_this._id].handlers.splice(handlerIndex, 1);\n\n                  if (thisOwner._listeningTo[_this._id].handlers.length === 0) {\n                    delete thisOwner._listeningTo[_this._id];\n                  }\n                }\n              }\n\n              _this._events[key].splice(index, 1);\n\n              if (event && handler) {\n                break;\n              }\n            } else {\n              index++;\n            }\n          }\n\n          if (_this._events[key].length === 0) {\n            delete _this._events[key];\n          }\n        };\n\n        if (event) {\n          if (this._events[event]) {\n            process(event);\n          }\n        } else {\n          for (var key in this._events) {\n            process(key);\n          }\n        }\n\n        return this;\n      }\n    },\n    trigger: {\n      enumerable: true,\n      value: function value(event) {\n        if (this._events[event]) {\n          var handlers = _toConsumableArray(this._events[event].map(function (_ref) {\n            var handler = _ref.handler;\n            return handler;\n          }));\n\n          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n          }\n\n          for (var index = 0, length = handlers.length; index < length; index++) {\n            var handler = handlers[index];\n            var returnValue = handler.call.apply(handler, [this].concat(args));\n\n            if (returnValue && returnValue.off) {\n              this.off(event, handler);\n            }\n          }\n        }\n\n        return this;\n      }\n    },\n    listenTo: {\n      enumerable: true,\n      value: function value(other, event, handler) {\n        other.on(event, handler, this);\n        return this;\n      }\n    },\n    stopListeningTo: {\n      enumerable: true,\n      value: function value(other, event, handler) {\n        var _this2 = this;\n\n        var process = function process(key) {\n          var ref = _this2._listeningTo[key].ref;\n          ref.off(event, handler, _this2);\n        };\n\n        if (other) {\n          if (this._listeningTo[other._id]) {\n            process(other._id);\n          }\n        } else {\n          for (var key in this._listeningTo) {\n            process(key);\n          }\n        }\n\n        return this;\n      }\n    },\n    terminate: {\n      enumerable: true,\n      value: function value() {\n        this.off();\n        this.stopListeningTo();\n      }\n    }\n  };\n\n  function factory() {\n    var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    Object.defineProperties(obj, propertyDescriptors);\n    return obj;\n  }\n\n  var Class = /*#__PURE__*/_createClass(function Class() {\n    _classCallCheck(this, Class);\n\n    this.initialize();\n  });\n\n  factory(Class.prototype);\n  var domPropertyDescriptors = Object.assign({}, propertyDescriptors, {\n    _listeners: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        propertyDescriptors.initialize.value.call(this);\n        this._listeners = {};\n      }\n    },\n    on: {\n      value: function value(event, handler, owner) {\n        var _this3 = this;\n\n        propertyDescriptors.on.value.call(this, event, handler, owner);\n\n        if (!this._listeners[event]) {\n          this.addEventListener(event, this._listeners[event] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            _this3.trigger.apply(_this3, [event].concat(args));\n          });\n        }\n\n        return this;\n      }\n    },\n    off: {\n      value: function value(event, handler, owner) {\n        var events = [];\n\n        if (event) {\n          if (this._events[event]) {\n            events.push(event);\n          }\n        } else {\n          for (var key in this._events) {\n            events.push(key);\n          }\n        }\n\n        propertyDescriptors.off.value.call(this, event, handler, owner);\n\n        for (var index = 0, length = events.length; index < length; index++) {\n          var _event = events[index];\n\n          if (this._listeners[_event] && !this._events[_event]) {\n            this.removeEventListener(_event, this._listeners[_event]);\n            delete this._listeners[_event];\n          }\n        }\n\n        return this;\n      }\n    }\n  });\n\n  function domFactory(dom) {\n    if (typeof dom === 'string') {\n      dom = document.getElementById(dom);\n    }\n\n    Object.defineProperties(dom, domPropertyDescriptors);\n    return dom;\n  }\n\n  return {\n    propertyDescriptors: propertyDescriptors,\n    factory: factory,\n    Class: Class,\n    domPropertyDescriptors: domPropertyDescriptors,\n    domFactory: domFactory\n  };\n}();\n/* exported Eventful */"],"names":["_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","Eventful","idCounter","propertyDescriptors","_id","_events","_listeningTo","initialize","value","this","concat","on","event","handler","owner","push","ref","handlers","off","process","index","_this","_this$_events$key$ind","thisHandler","thisOwner","handlerIndex","indexOf","splice","trigger","map","_ref","_len","arguments","args","_key","returnValue","apply","listenTo","other","stopListeningTo","_this2","terminate","factory","obj","undefined","defineProperties","Class","domPropertyDescriptors","assign","_listeners","_this3","addEventListener","_len2","_key2","events","_event","removeEventListener","domFactory","dom","document","getElementById"],"mappings":"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"}