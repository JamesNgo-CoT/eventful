{"version":3,"file":"eventful.min.js","sources":["eventful.min.js"],"sourcesContent":["\"use strict\";\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nvar Eventful = function () {\n  var idCounter = 0;\n  var propertyDescriptors = {\n    _id: {\n      writable: true\n    },\n    _events: {\n      writable: true\n    },\n    _listeningTo: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        this._id = \"eventful\".concat(idCounter++);\n        this._events = {};\n        this._listeningTo = {};\n        return this;\n      }\n    },\n    on: {\n      enumerable: true,\n      value: function value(event, handler, owner) {\n        if (!this._events[event]) {\n          this._events[event] = [];\n        }\n\n        var item = {\n          handler: handler\n        };\n\n        if (owner) {\n          item.owner = owner;\n\n          if (!owner._listeningTo[this._id]) {\n            owner._listeningTo[this._id] = {\n              ref: this,\n              handlers: []\n            };\n          }\n\n          owner._listeningTo[this._id].handlers.push(handler);\n        }\n\n        this._events[event].push(item);\n\n        return this;\n      }\n    },\n    off: {\n      enumerable: true,\n      value: function value(event, handler, owner) {\n        var _this = this;\n\n        var process = function process(key) {\n          var index = 0;\n\n          while (index < _this._events[key].length) {\n            var _this$_events$key$ind = _this._events[key][index],\n                thisHandler = _this$_events$key$ind.handler,\n                thisOwner = _this$_events$key$ind.owner;\n\n            if ((!handler || handler === thisHandler) && (!owner || owner === thisOwner)) {\n              if (thisOwner && thisOwner._listeningTo && thisOwner._listeningTo[_this._id]) {\n                var handlerIndex = thisOwner._listeningTo[_this._id].handlers.indexOf(thisHandler);\n\n                if (handlerIndex !== -1) {\n                  thisOwner._listeningTo[_this._id].handlers.splice(handlerIndex, 1);\n\n                  if (thisOwner._listeningTo[_this._id].handlers.length === 0) {\n                    delete thisOwner._listeningTo[_this._id];\n                  }\n                }\n              }\n\n              _this._events[key].splice(index, 1);\n\n              if (event && handler) {\n                break;\n              }\n            } else {\n              index++;\n            }\n          }\n\n          if (_this._events[key].length === 0) {\n            delete _this._events[key];\n          }\n        };\n\n        if (event) {\n          if (this._events[event]) {\n            process(event);\n          }\n        } else {\n          for (var key in this._events) {\n            process(key);\n          }\n        }\n\n        return this;\n      }\n    },\n    trigger: {\n      enumerable: true,\n      value: function value(event) {\n        if (this._events[event]) {\n          var handlers = _toConsumableArray(this._events[event].map(function (_ref) {\n            var handler = _ref.handler;\n            return handler;\n          }));\n\n          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n          }\n\n          for (var index = 0, length = handlers.length; index < length; index++) {\n            var handler = handlers[index];\n            var returnValue = handler.call.apply(handler, [this].concat(args));\n\n            if (returnValue && returnValue.off) {\n              this.off(event, handler);\n            }\n          }\n        }\n\n        return this;\n      }\n    },\n    listenTo: {\n      enumerable: true,\n      value: function value(other, event, handler) {\n        other.on(event, handler, this);\n        return this;\n      }\n    },\n    stopListeningTo: {\n      enumerable: true,\n      value: function value(other, event, handler) {\n        var _this2 = this;\n\n        var process = function process(key) {\n          var ref = _this2._listeningTo[key].ref;\n          ref.off(event, handler, _this2);\n        };\n\n        if (other) {\n          if (this._listeningTo[other._id]) {\n            process(other._id);\n          }\n        } else {\n          for (var key in this._listeningTo) {\n            process(key);\n          }\n        }\n\n        return this;\n      }\n    },\n    terminate: {\n      enumerable: true,\n      value: function value() {\n        this.off();\n        this.stopListeningTo();\n      }\n    }\n  };\n\n  function factory() {\n    var obj = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    return Object.defineProperties(obj, propertyDescriptors).initialize();\n  }\n\n  var Class = /*#__PURE__*/_createClass(function Class() {\n    _classCallCheck(this, Class);\n\n    this.initialize();\n  });\n\n  Object.defineProperties(Class.prototype, propertyDescriptors);\n  var domPropertyDescriptors = Object.assign({}, propertyDescriptors, {\n    _listeners: {\n      writable: true\n    },\n    initialize: {\n      enumerable: true,\n      value: function value() {\n        propertyDescriptors.initialize.value.call(this);\n        this._listeners = {};\n      }\n    },\n    on: {\n      value: function value(event, handler, owner) {\n        var _this3 = this;\n\n        propertyDescriptors.on.value.call(this, event, handler, owner);\n\n        if (!this._listeners[event]) {\n          this.addEventListener(event, this._listeners[event] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            _this3.trigger.apply(_this3, [event].concat(args));\n          });\n        }\n\n        return this;\n      }\n    },\n    off: {\n      value: function value(event, handler, owner) {\n        var events = [];\n\n        if (event) {\n          if (this._events[event]) {\n            events.push(event);\n          }\n        } else {\n          for (var key in this._events) {\n            events.push(key);\n          }\n        }\n\n        propertyDescriptors.off.value.call(this, event, handler, owner);\n\n        for (var index = 0, length = events.length; index < length; index++) {\n          var _event = events[index];\n\n          if (this._listeners[_event] && !this._events[_event]) {\n            this.removeEventListener(_event, this._listeners[_event]);\n            delete this._listeners[_event];\n          }\n        }\n\n        return this;\n      }\n    }\n  });\n\n  function domFactory(dom) {\n    if (typeof dom === 'string') {\n      dom = document.getElementById(dom);\n    }\n\n    return Object.defineProperties(dom, domPropertyDescriptors).initialize();\n  }\n\n  return {\n    propertyDescriptors: propertyDescriptors,\n    factory: factory,\n    Class: Class,\n    domPropertyDescriptors: domPropertyDescriptors,\n    domFactory: domFactory\n  };\n}();\n/* exported Eventful */"],"names":["_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","o","minLen","_arrayLikeToArray","n","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","arr2","Eventful","idCounter","propertyDescriptors","_id","_events","_listeningTo","initialize","value","this","concat","on","event","handler","owner","item","ref","handlers","push","off","process","index","_this","_this$_events$key$ind","thisHandler","thisOwner","handlerIndex","indexOf","splice","trigger","map","_ref","_len","arguments","args","_key","returnValue","apply","listenTo","other","stopListeningTo","_this2","terminate","Class","defineProperties","domPropertyDescriptors","assign","_listeners","_this3","addEventListener","_len2","_key2","events","_event","removeEventListener","factory","undefined","domFactory","dom","document","getElementById"],"mappings":"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"}